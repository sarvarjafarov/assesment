{% extends 'base.html' %}
{% load humanize static %}
{% block title %}{% if query %}Search: {{ query }} · {% endif %}Assessment Library · Evalon{% endblock %}
{% block meta_description %}Browse Evalon's ready-made assessments for marketing, product, behavioral, UX/UI design, HR, and finance roles. Pre-built question banks with automated scoring.{% endblock %}
{% block content %}
<div class="page-shell">
    {% include 'includes/site_header.html' with active='assessments' %}
    <main>
        <div class="al-shell" data-assessment-list-shell>
            <section class="al-hero">
                <p class="al-eyebrow">Assessment Library</p>
                <h1 class="al-title">{% if query %}Results for "{{ query }}"{% else %}Find the right assessment for every role{% endif %}</h1>
                {% if assessments %}
                <p class="al-desc">
                    {% if query %}
                    Found {{ assessments.paginator.count }} assessment{{ assessments.paginator.count|pluralize }} matching your search.
                    {% else %}
                    Pre-built question banks with scoring rubrics and real-world scenarios — covering marketing, product, behavioral, UX, HR, and finance.
                    {% endif %}
                </p>
                {% elif query %}
                <p class="al-desc">No assessments found. Try a different search term.</p>
                {% endif %}

                {# Trust stats #}
                <div class="al-trust-stats">
                    <span class="al-trust-stat">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                        <strong>500+</strong> companies
                    </span>
                    <span class="al-trust-stat">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                        <strong>6</strong> assessment types
                    </span>
                    <span class="al-trust-stat">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
                        AI-powered scoring
                    </span>
                    <span class="al-trust-stat">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        <strong>&lt; 45 min</strong> average
                    </span>
                </div>

                <form action="{% url 'pages:assessment_list' %}" method="get" class="al-search"
                      data-gtag-submit="assessment_search"
                      data-gtag-category="search"
                      data-gtag-label="assessment_library">
                    <div class="al-search-field">
                        <svg class="al-search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        <input type="search" name="q" value="{{ query }}" placeholder="Search assessments..." aria-label="Search assessments">
                    </div>
                </form>
            </section>

            <section class="al-grid" id="grid">
                {% for assessment in assessments %}
                <a class="al-card" href="{{ assessment.get_absolute_url }}"
                   style="--al-accent: {{ assessment.theme_color }}; --al-accent-rgb: {{ assessment.theme_rgb }}"
                   data-assessment-card
                   data-gtag-click="assessment_cta_click"
                   data-gtag-category="engagement"
                   data-gtag-label="{{ assessment.slug }}">
                    <div class="al-card-header">
                        <div class="al-card-icon">
                            {% if assessment.icon_svg %}
                            {{ assessment.icon_svg|safe }}
                            {% else %}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>
                            {% endif %}
                        </div>
                        <span class="al-card-label">{{ assessment.label }}</span>
                    </div>
                    <h3 class="al-card-title">{{ assessment.title }}</h3>
                    <p class="al-card-summary">{{ assessment.summary }}</p>
                    <div class="al-card-footer">
                        <div class="al-card-meta">
                            <span>{{ assessment.duration_minutes }} min</span>
                            <span class="al-meta-dot"></span>
                            <span>{{ assessment.question_count }} Qs</span>
                            <span class="al-meta-dot"></span>
                            <span class="al-difficulty al-difficulty--{{ assessment.difficulty_level }}">{{ assessment.get_difficulty_level_display }}</span>
                        </div>
                        <span class="al-card-arrow">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
                        </span>
                    </div>
                </a>
                {% empty %}
                    <div class="al-empty">
                        <h3>No assessments found</h3>
                        <p>{% if query %}Try adjusting your search or <a href="{% url 'pages:assessment_list' %}">browse all assessments</a>.{% else %}Check back soon for new assessments.{% endif %}</p>
                    </div>
                {% endfor %}
            </section>

            {% if is_paginated and page_obj.has_next %}
            <div class="al-load-more">
                <a class="al-load-btn"
                   href="?{% if query %}q={{ query|urlencode }}&{% endif %}page={{ page_obj.next_page_number }}"
                   data-gtag-click="assessment_load_more_click"
                   data-gtag-category="engagement"
                   data-gtag-label="load_more">Load more assessments</a>
            </div>
            {% endif %}

            {# Bottom CTA #}
            <section class="al-cta">
                <div class="al-cta-inner">
                    <h2>Not sure which assessment fits?</h2>
                    <p>Talk to our team for a personalized recommendation — or start free and explore on your own.</p>
                    <div class="al-cta-actions">
                        <a class="ad-btn-primary" href="{% url 'clients:signup' %}"
                           data-gtag-click="assessment_list_cta_click"
                           data-gtag-category="engagement"
                           data-gtag-label="list_cta_trial">Start Free Trial</a>
                        <a class="ad-btn-secondary" href="{% url 'pages:contact' %}"
                           data-gtag-click="contact_sales_click"
                           data-gtag-category="engagement"
                           data-gtag-label="list_cta_sales">Contact Sales</a>
                    </div>
                </div>
            </section>
        </div>
    </main>
</div>
{% endblock %}
