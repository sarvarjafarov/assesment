{% extends 'base.html' %}
{% load humanize static %}
{% block title %}{% if query %}Search: {{ query }} · {% endif %}Assessment Library · Evalon{% endblock %}
{% block meta_description %}Browse Evalon's ready-made assessments for marketing, product, behavioral, UX/UI design, HR, and finance roles. Pre-built question banks with automated scoring.{% endblock %}
{% block content %}
<div class="page-shell">
    {% include 'includes/site_header.html' with active='assessments' %}
    <main>
        <div class="assessments-shell" data-assessment-list-shell>
            <section class="assessments-hero">
                <p class="eyebrow">Assessment Library</p>
                <h1>{% if query %}Results for "{{ query }}"{% else %}Ready-made assessments for key roles{% endif %}</h1>
                {% if assessments %}
                <p class="lede">
                    {% if query %}
                    Found {{ assessments.paginator.count }} assessment{{ assessments.paginator.count|pluralize }} matching your search.
                    {% else %}
                    Pre-built question banks covering marketing, product, behavioral, UX/UI design, HR, and finance roles. Each includes scoring rubrics and real-world scenarios.
                    {% endif %}
                </p>
                {% elif query %}
                <p class="lede">No assessments found. Try a different search term.</p>
                {% endif %}
            </section>

            {# Search bar #}
            <section class="assessments-search-bar">
                <form action="{% url 'pages:assessment_list' %}" method="get" class="search-form">
                    <input type="search" name="q" value="{{ query }}" placeholder="Search assessments..." aria-label="Search assessments">
                    <button type="submit" class="btn btn-pill">Search</button>
                </form>
            </section>

            <section class="assessments-grid" id="grid">
                {% for assessment in assessments %}
                <article class="assessment-card" data-assessment-card>
                    <div class="assessment-card-icon">
                        {% if assessment.icon_svg %}
                        {{ assessment.icon_svg|safe }}
                        {% else %}
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 11l3 3L22 4"></path>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                        </svg>
                        {% endif %}
                    </div>
                    <span class="pill subtle">{{ assessment.label }}</span>
                    <h3><a href="{{ assessment.get_absolute_url }}">{{ assessment.title }}</a></h3>
                    <p class="assessment-summary">{{ assessment.summary }}</p>
                    {% if assessment.focus_list %}
                    <ul class="focus-list">
                        {% for focus in assessment.focus_list %}
                        <li>{{ focus }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    <div class="assessment-meta">
                        <span>{{ assessment.duration_minutes }} min</span>
                        <span>{{ assessment.question_count }} questions</span>
                        <span>{{ assessment.get_difficulty_level_display }}</span>
                    </div>
                    <a class="btn btn-outline small" href="{{ assessment.get_absolute_url }}">Learn more</a>
                </article>
                {% empty %}
                <div class="empty-state-box">
                    <h3>No assessments found</h3>
                    <p>{% if query %}Try adjusting your search or <a href="{% url 'pages:assessment_list' %}">browse all assessments</a>.{% else %}Check back soon for new assessments.{% endif %}</p>
                </div>
                {% endfor %}
            </section>

            {% if is_paginated and page_obj.has_next %}
            <div class="assessments-load-more">
                <a class="btn btn-pill secondary" href="?{% if query %}q={{ query|urlencode }}&{% endif %}page={{ page_obj.next_page_number }}">Load more</a>
            </div>
            {% endif %}
        </div>
    </main>
</div>
{% endblock %}
