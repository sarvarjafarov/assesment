{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ position.title }} &mdash; {{ client.company_name }}</title>
    <meta name="description" content="Apply for {{ position.title }} at {{ client.company_name }}.">
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/portal-pages.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-primary: {{ client.brand_primary_color|default:"#ff8a00" }};
            --brand-secondary: {{ client.brand_secondary_color|default:"#0e1428" }};
        }
    </style>
</head>
<body class="vc-body">

    {# ── Mini Hero Bar ── #}
    <div class="vc-detail-bar">
        <div class="vc-detail-bar-inner">
            <nav class="vc-breadcrumb">
                <a href="{% url 'pages:vacancy_list' company_slug=client.slug %}">
                    {% if client.logo_data_url %}
                    <img src="{{ client.logo_data_url }}" alt="" class="vc-bc-logo">
                    {% endif %}
                    {{ client.company_name }}
                </a>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity=".4"><polyline points="9 18 15 12 9 6"></polyline></svg>
                <span>{{ position.title }}</span>
            </nav>
        </div>
    </div>

    <div class="vc-shell">
        {# ── Position Hero ── #}
        <header class="vc-pos-hero vc-anim" style="--d:0.05s">
            <h1>{{ position.title }}</h1>
            {% if position.department or position.location %}
            <div class="vc-pos-meta">
                {% if position.department %}
                <span class="vc-pos-chip">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
                    {{ position.department }}
                </span>
                {% endif %}
                {% if position.location %}
                <span class="vc-pos-chip">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                    {{ position.location }}
                </span>
                {% endif %}
                {% if position.employment_type %}
                <span class="vc-pos-chip">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                    {{ position.get_employment_type_display }}
                </span>
                {% endif %}
                {% if position.work_model %}
                <span class="vc-pos-chip">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                    {{ position.get_work_model_display }}
                </span>
                {% endif %}
            </div>
            {% endif %}
        </header>

        <div class="vc-position-layout">
            {# ── Left: Info ── #}
            <div class="vc-position-info">
                {% if position.salary_display or position.open_roles %}
                <div class="vc-highlights vc-anim" style="--d:0.1s">
                    {% if position.salary_display %}
                    <div class="vc-highlight">
                        <div class="vc-highlight-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--brand-primary)" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                        </div>
                        <div>
                            <span class="vc-highlight-label">Salary Range</span>
                            <span class="vc-highlight-val">{{ position.salary_display }}</span>
                        </div>
                    </div>
                    {% endif %}
                    <div class="vc-highlight">
                        <div class="vc-highlight-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--brand-primary)" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                        </div>
                        <div>
                            <span class="vc-highlight-label">Open Roles</span>
                            <span class="vc-highlight-val">{{ position.open_roles }} position{{ position.open_roles|pluralize }}</span>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% if position.description %}
                <div class="vc-description vc-anim" style="--d:0.15s">
                    <h2>About this role</h2>
                    <div class="vc-desc-body">{{ position.description|linebreaksbr }}</div>
                </div>
                {% endif %}

                {% if position.skills_list %}
                <div class="vc-skills vc-anim" style="--d:0.2s">
                    <h3>Required Skills</h3>
                    <div class="vc-skill-pills">
                        {% for skill in position.skills_list %}
                        <span class="vc-skill-pill">{{ skill }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>

            {# ── Right: Apply Panel ── #}
            <aside class="vc-apply-panel vc-anim" style="--d:0.12s">
                <div class="vc-apply-accent"></div>
                <div class="vc-apply-head">
                    <div class="vc-apply-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                    </div>
                    <div>
                        <h2>Apply now</h2>
                        <p class="vc-apply-sub">Takes less than 2 minutes</p>
                    </div>
                </div>
                <form method="post" action="{% url 'pages:vacancy_apply' company_slug=client.slug position_uuid=position.uuid %}" enctype="multipart/form-data" class="vc-apply-form">
                    {% csrf_token %}
                    {% for field in form %}
                    <div class="vc-field">
                        <label for="{{ field.id_for_label }}">{{ field.label }}{% if field.field.required %} <span class="vc-req">*</span>{% endif %}</label>
                        {{ field }}
                        {% if field.help_text %}<span class="vc-help">{{ field.help_text }}</span>{% endif %}
                        {% for error in field.errors %}
                        <span class="vc-error">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endfor %}
                    <button type="submit" class="vc-submit">
                        <span>Submit Application</span>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                    </button>
                </form>
            </aside>
        </div>

        <footer class="vc-footer">
            <span>Powered by <a href="{% url 'pages:home' %}">Evalon</a></span>
        </footer>
    </div>
</body>
</html>
